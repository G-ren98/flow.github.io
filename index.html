<!DOCTYPE html>
<html>
<head>
    <title>BPMN Viewer</title>
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/diagram-js.css" />
    <link rel="stylesheet" href="https://unpkg.com/bpmn-js/dist/assets/bpmn-font/css/bpmn.css" />
    <style>
        html, body {
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        .container {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
        }
        
        #canvas {
            height: 90%;
            width: 90%;
            border: 1px solid #eee;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .tooltip-panel {
            position: absolute;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: none;
            z-index: 1000;
            min-width: 200px;
        }

        /* 自定义流程节点样式 */
        .completed-task {
            fill: #e3f2fd !important;  /* 已完成的任务背景色 */
            stroke: #1976d2 !important;  /* 已完成的任务边框色 */
        }

        .active-task {
            fill: #fff3e0 !important;  /* 当前活动任务背景色 */
            stroke: #f57c00 !important;  /* 当前活动任务边框色 */
        }

        .pending-task {
            fill: #fafafa !important;  /* 待处理任务背景色 */
            stroke: #9e9e9e !important;  /* 待处理任务边框色 */
        }

        /* 连接线样式 */
        .completed-path {
            stroke: #1976d2 !important;  /* 已完成路径的颜色 */
            marker-end: url(#completed-arrow) !important;
        }

        /* 提示框样式美化 */
        .tooltip-content {
            font-size: 13px;
            line-height: 1.6;
        }

        .tooltip-row {
            margin-bottom: 8px;
        }

        .tooltip-label {
            color: #666;
            font-weight: 500;
            margin-right: 8px;
        }

        .tooltip-value {
            color: #333;
            word-break: break-word;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="canvas"></div>
        <div id="tooltip-panel" class="tooltip-panel"></div>
    </div>

    <script src="https://unpkg.com/bpmn-js/dist/bpmn-viewer.production.min.js"></script>
    <script>
        // 定义变量
        const user = 'defaultUser';
        const group = 'defaultGroup';
        const result = 'defaultResult';
        const processResult = 'defaultProcessResult'
        const Ztype = 'defaultZtype'
        const Atype = 'defaultAtype'
        const EOMStype = 'defaultEOMStype'
        const checkResult = 'defaultcheckResult'
        // 任务数据
        const taskData = {"code": 200, "msg": "ok", "description": "ok", "success": true, "data": [{"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "67bc3692-cdb4-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "gdfq", "taskName": "\u5de5\u5355\u53d1\u8d77", "handlerAccount": "hndw_wangyali", "handler": "\u738b\u96c5\u8389", "handlerContact": "17872392996", "dept": "", "role": "", "team": "\u533a\u53bf\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:33:38", "endTime": "2025-01-08 19:33:40", "taskIndex": "", "opData": "{\"A\u7aef\u6240\u5c5e\u533a\u53bf\":\"\",\"A\u7aef\u6240\u5c5e\u5730\u5e02\":\"\",\"A\u7aef\u6d3e\u53d1\u6e20\u9053\":\"\",\"dataFactory\":[{\"\u5de5\u5355\u6240\u5c5e\u7aef\":\"Z\u7aef\"},{\"\u5de5\u5355\u7f16\u53f7\":\"SNTSNEW-20250108-0042\"},{\"\u6545\u969c\u5730\u70b9\":\"\u5b81\u4e61\u575d\u5858\u957f\u5174\u6751\u6751\u90e8\"},{\"\u6295\u8bc9\u5185\u5bb9\":\"13617314722\u5ba2\u6237\u53cd\u6620\u4e13\u7ebf\u65e0\u6cd5\u8054\u7f51\uff0c\u8054\u7cfb13617314722 \u540d\u79f0\uff1a\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3 \u5730\u5740\uff1a\u5b81\u4e61\u575d\u5858\u957f\u5174\u6751\u6751\u90e8\u53d7\u7406\u7c7b\u578b\uff1a\u96c6\u56e2\u4e1a\u52a1-\u7f51\u7edc\u8d28\u91cf-\u4e13\u7ebf\u4e13\u7f51-\u653f\u4f01\u4e13\u7f51-\u529f\u80fd\u4f7f\u7528-\u4e13\u7ebf\u4e2d\u65ad-\u5168\u5c40\u6d41\u8f6c-CRM\u8ba2\u5355\u53f7\uff1a20250108193105X865899835\"},{\"\u5ba2\u6237\u7f16\u53f7\":\"\"},{\"\u662f\u5426\u91cd\u4fdd\u5ba2\u6237\":\"\u5426\"},{\"\u6295\u8bc9\u8054\u7cfb\u4eba\u7535\u8bdd\":\"13617314722\"},{\"\u4e1a\u52a1\u4e3b\u952e\":\"SNTSNEW-20250108-0042\"},{\"\u7535\u5b50\u8fd0\u7ef4\u5de5\u5355\u53f7\":\"HN-056-250108-02798\"},{\"A\u7aef\u6d3e\u53d1\u6e20\u9053\":\"\"},{\"A\u7aef\u6240\u5c5e\u533a\u53bf\":\"\"},{\"\u5ba2\u6237\u540d\u79f0/\u96c6\u56e2\u540d\u79f0\":\"\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3\"},{\"\u662f\u5426\u5206\u6d3e\u4e24\u7aef\":\"\u5426\"},{\"\u6295\u8bc9\u7c7b\u578b\":\"\u4e2d\u65ad\u7c7b\u6295\u8bc9\"},{\"\u6545\u969c\u7c7b\u578b\":\"\u4e13\u7ebf\u6545\u969c\"},{\"A\u7aef\u6240\u5c5e\u5730\u5e02\":\"\"},{\"\u4ea7\u54c1\u5b9e\u4f8b\u6807\u8bc6\":\"\"},{\"\u5904\u7406\u65f6\u9650\":\"2025-01-08 23:33:38\"},{\"\u6240\u5c5e\u533a\u53bf\":\"\u5b81\u4e61\u5e02\"},{\"\u6295\u8bc9\u8054\u7cfb\u4eba\":\"\u65e0\"},{\"\u4e1a\u52a1\u7c7b\u578b\":\"\u4e92\u8054\u7f51\u4e13\u7ebf\"},{\"\u53d7\u7406\u65f6\u9650\":\"2025-01-08 19:48:38\"},{\"\u5de5\u5355\u6807\u9898\":\"\u5728\u7ebf\u6295\u8bc9-\u3010\u7f51\u7edc\u7c7b\u6295\u8bc9\u3011-\u4e92\u8054\u7f51\u4e13\u7ebf-\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3-\u65e0\u6295\u8bc9\"},{\"\u6d3e\u53d1\u6e20\u9053\":\"\u5b81\u4e61\u5e02\u7ef4\u62a4\u73ed\u7ec4\"},{\"\u6d3e\u5355\u65f6\u95f4\":\"2025-01-08 19:33:38\"},{\"\u53d7\u7406\u5f00\u59cb\u65f6\u95f4\":\"2025-01-08 19:33:38\"},{\"\u6545\u969c\u65f6\u95f4\":\"2025-01-08 19:33:37\"},{\"\u7535\u5b50\u8fd0\u7ef4\u5de5\u5355\u6d41\u6c34\u53f7\":\"173633593812291\"},{\"\u6240\u5c5e\u5730\u5e02\":\"\u957f\u6c99\"}],\"\u4e1a\u52a1\u4e3b\u952e\":\"SNTSNEW-20250108-0042\",\"\u4e1a\u52a1\u7c7b\u578b\":\"\u4e92\u8054\u7f51\u4e13\u7ebf\",\"\u4ea7\u54c1\u5b9e\u4f8b\u6807\u8bc6\":\"\",\"\u53d7\u7406\u5f00\u59cb\u65f6\u95f4\":\"2025-01-08 19:33:38\",\"\u53d7\u7406\u65f6\u9650\":\"2025-01-08 19:48:38\",\"\u5904\u7406\u65f6\u9650\":\"2025-01-08 23:33:38\",\"\u5ba2\u6237\u540d\u79f0/\u96c6\u56e2\u540d\u79f0\":\"\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3\",\"\u5ba2\u6237\u7f16\u53f7\":\"\",\"\u5de5\u5355\u6240\u5c5e\u7aef\":\"Z\u7aef\",\"\u5de5\u5355\u6807\u9898\":\"\u5728\u7ebf\u6295\u8bc9-\u3010\u7f51\u7edc\u7c7b\u6295\u8bc9\u3011-\u4e92\u8054\u7f51\u4e13\u7ebf-\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3-\u65e0\u6295\u8bc9\",\"\u5de5\u5355\u7f16\u53f7\":\"SNTSNEW-20250108-0042\",\"\u6240\u5c5e\u533a\u53bf\":\"\u5b81\u4e61\u5e02\",\"\u6240\u5c5e\u5730\u5e02\":\"\u957f\u6c99\",\"\u6295\u8bc9\u5185\u5bb9\":\"13617314722\u5ba2\u6237\u53cd\u6620\u4e13\u7ebf\u65e0\u6cd5\u8054\u7f51\uff0c\u8054\u7cfb13617314722 \u540d\u79f0\uff1a\u5b81\u4e61\u5e02\u6570\u636e\u8d44\u6e90\u4e2d\u5fc3 \u5730\u5740\uff1a\u5b81\u4e61\u575d\u5858\u957f\u5174\u6751\u6751\u90e8\u53d7\u7406\u7c7b\u578b\uff1a\u96c6\u56e2\u4e1a\u52a1-\u7f51\u7edc\u8d28\u91cf-\u4e13\u7ebf\u4e13\u7f51-\u653f\u4f01\u4e13\u7f51-\u529f\u80fd\u4f7f\u7528-\u4e13\u7ebf\u4e2d\u65ad-\u5168\u5c40\u6d41\u8f6c-CRM\u8ba2\u5355\u53f7\uff1a20250108193105X865899835\",\"\u6295\u8bc9\u7c7b\u578b\":\"\u4e2d\u65ad\u7c7b\u6295\u8bc9\",\"\u6295\u8bc9\u8054\u7cfb\u4eba\":\"\u65e0\",\"\u6295\u8bc9\u8054\u7cfb\u4eba\u7535\u8bdd\":\"13617314722\",\"\u6545\u969c\u5730\u70b9\":\"\u5b81\u4e61\u575d\u5858\u957f\u5174\u6751\u6751\u90e8\",\"\u6545\u969c\u65f6\u95f4\":\"2025-01-08 19:33:37\",\"\u6545\u969c\u7c7b\u578b\":\"\u4e13\u7ebf\u6545\u969c\",\"\u662f\u5426\u5206\u6d3e\u4e24\u7aef\":\"\u5426\",\"\u662f\u5426\u91cd\u4fdd\u5ba2\u6237\":\"\u5426\",\"\u6d3e\u5355\u65f6\u95f4\":\"2025-01-08 19:33:38\",\"\u6d3e\u53d1\u6e20\u9053\":\"\u5b81\u4e61\u5e02\u7ef4\u62a4\u73ed\u7ec4\",\"\u7535\u5b50\u8fd0\u7ef4\u5de5\u5355\u53f7\":\"HN-056-250108-02798\",\"\u7535\u5b50\u8fd0\u7ef4\u5de5\u5355\u6d41\u6c34\u53f7\":\"173633593812291\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "\u7701\u7ea7\u8c03\u5ea6\u4e2d\u5fc3\u6d3e\u5355"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "68a92eb8-cdb4-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdfp", "taskName": "Z\u7aef\u5de5\u5355\u5206\u6d3e", "handlerAccount": "hndw_wangyali", "handler": "\u738b\u96c5\u8389", "handlerContact": "17872392996", "dept": "", "role": "", "team": "\u7701\u7ea7\u8c03\u5ea6\u4e2d\u5fc3", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:33:40", "endTime": "2025-01-08 19:33:45", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"},{\"\u6d3e\u53d1\u6e20\u9053\":\"\u5b81\u4e61\u5e02\u7ef4\u62a4\u73ed\u7ec4\"}],\"Z\u7aef\u73ed\u7ec4\":\"\u5b81\u4e61\u5e02\u7ef4\u62a4\u73ed\u7ec4\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "\u8c03\u5ea6\u4e2d\u5fc3\u5df2\u5206\u6d3e"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "6b64a549-cdb4-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdsl", "taskName": "Z\u7aef\u5de5\u5355\u53d7\u7406", "handlerAccount": "csdw_zhurongrong", "handler": "\u6731\u84c9\u84c9", "handlerContact": "", "dept": "", "role": "", "team": "\u5b81\u4e61\u5e02\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:33:45", "endTime": "2025-01-08 19:37:08", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u53d7\u7406\u7ed3\u679c\":\"\u53d7\u7406\u901a\u8fc7\"},{\"\u53d7\u7406\u7aef\":\"Z\u7aef\"},{\"\u9a73\u56de\u539f\u56e0\":\"\"},{\"\u5907\u6ce8\":\"\"},{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"}],\"\u53d7\u7406\u7aef\":\"Z\u7aef\",\"\u53d7\u7406\u7ed3\u679c\":\"\u53d7\u7406\u901a\u8fc7\",\"\u5907\u6ce8\":\"\",\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\",\"\u9a73\u56de\u539f\u56e0\":\"\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "csdw_zhurongrong\u5df2\u53d7\u7406"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "e4b5c659-cdb4-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdyy", "taskName": "Z\u7aef\u5de5\u5355\u9884\u7ea6", "handlerAccount": "csdw_zhurongrong", "handler": "\u6731\u84c9\u84c9", "handlerContact": "", "dept": "", "role": "", "team": "\u533a\u53bf\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:37:08", "endTime": "2025-01-08 19:38:49", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u9884\u7ea6\u7ed3\u679c\":\"\u901a\u8fc7\"},{\"\u8ba1\u5212\u4e0a\u95e8\u65f6\u95f4\":\"2025-01-08 19:38:00\"},{\"\u53d7\u7406\u7aef\":\"Z\u7aef\"},{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"}],\"\u53d7\u7406\u7aef\":\"Z\u7aef\",\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\",\"\u8ba1\u5212\u4e0a\u95e8\u65f6\u95f4\":\"2025-01-08 19:38:00\",\"\u9884\u7ea6\u7ed3\u679c\":\"\u901a\u8fc7\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "csdw_zhurongrong\u5df2\u9884\u7ea6"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "2092a277-cdb5-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdsm", "taskName": "Z\u7aef\u5de5\u5355\u4e0a\u95e8", "handlerAccount": "csdw_zhurongrong", "handler": "\u6731\u84c9\u84c9", "handlerContact": "", "dept": "", "role": "", "team": "\u533a\u53bf\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:38:49", "endTime": "2025-01-08 19:38:53", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u4e0a\u95e8\u7b7e\u5230\u65f6\u95f4\":\"2025-01-08 19:38:51\"},{\"\u4e0a\u95e8\u5b9a\u4f4d\u7ecf\u5ea6\":\"-\"},{\"\u53d7\u7406\u7aef\":\"Z\u7aef\"},{\"\u4e0a\u95e8\u5b9a\u4f4d\u7eac\u5ea6\":\"-\"},{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"}],\"\u4e0a\u95e8\u5b9a\u4f4d\u7eac\u5ea6\":\"-\",\"\u4e0a\u95e8\u5b9a\u4f4d\u7ecf\u5ea6\":\"-\",\"\u4e0a\u95e8\u7b7e\u5230\u65f6\u95f4\":\"2025-01-08 19:38:51\",\"\u53d7\u7406\u7aef\":\"Z\u7aef\",\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "csdw_zhurongrong\u5df2\u4e0a\u95e8"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "23519b74-cdb5-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdcl", "taskName": "Z\u7aef\u5de5\u5355\u5904\u7406", "handlerAccount": "csdw_zhurongrong", "handler": "\u6731\u84c9\u84c9", "handlerContact": "", "dept": "", "role": "", "team": "\u533a\u53bf\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 19:38:53", "endTime": "2025-01-08 20:43:48", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u5ba2\u6237\u53cd\u5e94\u5b9e\u9645\u60c5\u51b5\":\"\u7ef4\u62a4\u5458\u5f6d\u5a01\u73b0\u573a\u6838\u5b9e\u56e0\u5c3e\u7ea4\u65ad\u5bfc\u81f4\u6545\u969c\uff0c\u66f4\u6362\u5c3e\u7ea4\u6062\u590d\uff0c\u5ba2\u6237\u6ee1\u610f\u3002\n\u8d23\u4efb\u4e3b\u4f53:\u79fb\u52a8\u4fa7\"},{\"\u8bbe\u5907\u5382\u5bb6\":\"\"},{\"\u5ba2\u6237\u673a\u623f\u662f\u5426\u5b58\u5728\u7ade\u5bf9\u5149\u7f06\u63a5\u5165\":\"\"},{\"\u53d7\u7406\u7aef\":\"Z\u7aef\"},{\"\u89e3\u51b3\u7ed3\u679c\":\"\u5df2\u89e3\u51b3\"},{\"\u8bbe\u5907\u578b\u53f7\":\"\"},{\"\u4ea7\u54c1\u5b9e\u4f8b\u6807\u8bc6\":\"31VN07Y1007\"},{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"},{\"\u6295\u8bc9\u4e00\u7ea7\u5206\u7c7b\":\"\u79fb\u52a8\u63a5\u5165\u6bb5\u6545\u969c\"},{\"\u89e3\u51b3\u63aa\u65bd\":\"\u7ef4\u62a4\u63aa\u65bd-\u6392\u969c\"},{\"\u56de\u5355\u65b9\u5f0f\":\"\u65e0\u7801\u56de\u5355\"},{\"\u662f\u5426\u8d23\u4efb\u7aef\":\"\u5426\"},{\"\u4e1a\u52a1\u7c7b\u578b\":\"\u4e92\u8054\u7f51\u4e13\u7ebf\"},{\"\u5904\u7406\u7ed3\u679c\":\"\u6ee1\u610f\"},{\"\u5ef6\u671f\u539f\u56e0\":\"\"},{\"\u6295\u8bc9\u539f\u56e0\":\"\u4e1a\u52a1\u4e2d\u65ad\"},{\"\u6295\u8bc9\u89e3\u51b3\u65f6\u95f4\":\"2025-01-08 20:42:00\"},{\"\u8ba1\u5212\u89e3\u51b3\u65f6\u95f4\":\"\"},{\"\u7ade\u5bf9\u5149\u7f06\u662f\u5426\u4e2d\u65ad\":\"\"},{\"\u6295\u8bc9\u4e8c\u7ea7\u5206\u7c7b\":\"\u8fde\u63a5\u4ef6\u7b49\u54d1\u8bbe\u5907\u6545\u969c\"},{\"\u5904\u7406\u8fc7\u7a0b\":\"\u7ef4\u62a4\u5458\u5f6d\u5a01\u73b0\u573a\u6838\u5b9e\u56e0\u5c3e\u7ea4\u65ad\u5bfc\u81f4\u6545\u969c\uff0c\u66f4\u6362\u5c3e\u7ea4\u6062\u590d\uff0c\u5ba2\u6237\u6ee1\u610f\u3002\n\u8d23\u4efb\u4e3b\u4f53:\u79fb\u52a8\u4fa7\"},{\"\u5ef6\u671f\u8bf4\u660e\":\"\"},{\"\u65e0\u7801\u56de\u5355\u8bf4\u660e\":\"18\u70b9\u540e\u65e0\u7801\"}],\"\u4e1a\u52a1\u7c7b\u578b\":\"\u4e92\u8054\u7f51\u4e13\u7ebf\",\"\u4ea7\u54c1\u5b9e\u4f8b\u6807\u8bc6\":\"31VN07Y1007\",\"\u53d7\u7406\u7aef\":\"Z\u7aef\",\"\u56de\u5355\u65b9\u5f0f\":\"\u65e0\u7801\u56de\u5355\",\"\u5904\u7406\u7ed3\u679c\":\"\u6ee1\u610f\",\"\u5904\u7406\u8fc7\u7a0b\":\"\u7ef4\u62a4\u5458\u5f6d\u5a01\u73b0\u573a\u6838\u5b9e\u56e0\u5c3e\u7ea4\u65ad\u5bfc\u81f4\u6545\u969c\uff0c\u66f4\u6362\u5c3e\u7ea4\u6062\u590d\uff0c\u5ba2\u6237\u6ee1\u610f\u3002\n\u8d23\u4efb\u4e3b\u4f53:\u79fb\u52a8\u4fa7\",\"\u5ba2\u6237\u53cd\u5e94\u5b9e\u9645\u60c5\u51b5\":\"\u7ef4\u62a4\u5458\u5f6d\u5a01\u73b0\u573a\u6838\u5b9e\u56e0\u5c3e\u7ea4\u65ad\u5bfc\u81f4\u6545\u969c\uff0c\u66f4\u6362\u5c3e\u7ea4\u6062\u590d\uff0c\u5ba2\u6237\u6ee1\u610f\u3002\n\u8d23\u4efb\u4e3b\u4f53:\u79fb\u52a8\u4fa7\",\"\u5ba2\u6237\u673a\u623f\u662f\u5426\u5b58\u5728\u7ade\u5bf9\u5149\u7f06\u63a5\u5165\":\"\",\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\",\"\u5ef6\u671f\u539f\u56e0\":\"\",\"\u5ef6\u671f\u8bf4\u660e\":\"\",\"\u6295\u8bc9\u4e00\u7ea7\u5206\u7c7b\":\"\u79fb\u52a8\u63a5\u5165\u6bb5\u6545\u969c\",\"\u6295\u8bc9\u4e8c\u7ea7\u5206\u7c7b\":\"\u8fde\u63a5\u4ef6\u7b49\u54d1\u8bbe\u5907\u6545\u969c\",\"\u6295\u8bc9\u539f\u56e0\":\"\u4e1a\u52a1\u4e2d\u65ad\",\"\u6295\u8bc9\u89e3\u51b3\u65f6\u95f4\":\"2025-01-08 20:42:00\",\"\u65e0\u7801\u56de\u5355\u8bf4\u660e\":\"18\u70b9\u540e\u65e0\u7801\",\"\u662f\u5426\u8d23\u4efb\u7aef\":\"\u5426\",\"\u7ade\u5bf9\u5149\u7f06\u662f\u5426\u4e2d\u65ad\":\"\",\"\u89e3\u51b3\u63aa\u65bd\":\"\u7ef4\u62a4\u63aa\u65bd-\u6392\u969c\",\"\u89e3\u51b3\u7ed3\u679c\":\"\u5df2\u89e3\u51b3\",\"\u8ba1\u5212\u89e3\u51b3\u65f6\u95f4\":\"\",\"\u8bbe\u5907\u5382\u5bb6\":\"\",\"\u8bbe\u5907\u578b\u53f7\":\"\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "csdw_zhurongrong\u5df2\u5904\u7406"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "34c1a225-cdbe-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "zdgdzj", "taskName": "Z\u7aef\u5de5\u5355\u8d28\u68c0", "handlerAccount": "csdw_lujiayi", "handler": "\u82a6\u5609\u827a", "handlerContact": "19573184172", "dept": "", "role": "", "team": "\u957f\u6c99\u552e\u540e\u8c03\u5ea6\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 20:43:48", "endTime": "2025-01-08 20:56:16", "taskIndex": "", "opData": "{\"dataFactory\":[{\"\u8d28\u68c0\u7ed3\u679c\":\"\u901a\u8fc7\"},{\"\u56de\u8bbf\u5185\u5bb9\":\"ok\"},{\"\u56de\u8bbf\u8054\u7cfb\u4eba\":\"13617314722\"},{\"\u53d7\u7406\u7aef\":\"Z\u7aef\"},{\"\u56de\u8bbf\u65f6\u95f4\":\"2025-01-08 20:55:17\"},{\"\u9a73\u56de\u7aef\":\"\"},{\"\u6ee1\u610f\u5ea6\u56de\u8bbf\u5907\u6ce8\":\"ok\"},{\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\"},{\"\u4e0d\u901a\u8fc7\u539f\u56e0\u5206\u7c7b\":\"\"},{\"\u4e0d\u901a\u8fc7\u539f\u56e0\u8bf4\u660e\":\"\"},{\"\u6ee1\u610f\u5ea6\u56de\u8bbf\u7ed3\u679c\":\"\u6ee1\u610f\"},{\"\u56de\u8bbf\u8054\u7cfb\u4eba\u7535\u8bdd\":\"13617314722\"},{\"\u4e91\u5ba2\u670d\u6d41\u6c34\u53f7\":\"S20250108205349141194AC1303E102290425\"}],\"\u4e0d\u901a\u8fc7\u539f\u56e0\u5206\u7c7b\":\"\",\"\u4e0d\u901a\u8fc7\u539f\u56e0\u8bf4\u660e\":\"\",\"\u4e91\u5ba2\u670d\u6d41\u6c34\u53f7\":\"S20250108205349141194AC1303E102290425\",\"\u53d7\u7406\u7aef\":\"Z\u7aef\",\"\u56de\u8bbf\u5185\u5bb9\":\"ok\",\"\u56de\u8bbf\u65f6\u95f4\":\"2025-01-08 20:55:17\",\"\u56de\u8bbf\u8054\u7cfb\u4eba\":\"13617314722\",\"\u56de\u8bbf\u8054\u7cfb\u4eba\u7535\u8bdd\":\"13617314722\",\"\u5de5\u5355\u53f7\":\"SNTSNEW-20250108-0042\",\"\u6ee1\u610f\u5ea6\u56de\u8bbf\u5907\u6ce8\":\"ok\",\"\u6ee1\u610f\u5ea6\u56de\u8bbf\u7ed3\u679c\":\"\u6ee1\u610f\",\"\u8d28\u68c0\u7ed3\u679c\":\"\u901a\u8fc7\",\"\u9a73\u56de\u7aef\":\"\"}", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "\u8c03\u5ea6\u4e2d\u5fc3\u5df2\u8d28\u68c0"}, {"orderId": "SNTSNEW-20250108-0042", "orderType": null, "taskNo": "f2e3fce9-cdbf-11ef-bb3c-fa163e5f89fd", "flowId": null, "taskDefKey": "gd", "taskName": "\u5f52\u6863", "handlerAccount": "csdw_lujiayi", "handler": "\u82a6\u5609\u827a", "handlerContact": "19573184172", "dept": "", "role": "", "team": "\u533a\u53bf\u7ef4\u62a4\u73ed\u7ec4", "opType": "\u63d0\u4ea4", "reason": "", "remark": "", "startTime": "2025-01-08 20:56:16", "endTime": "2025-01-08 20:56:18", "taskIndex": "", "opData": "", "cityId": null, "cityName": null, "dealLimit": null, "createTime": null, "opResult": "\u8c03\u5ea6\u4e2d\u5fc3\u5df2\u5f52\u6863"}], "sql": null, "timeTake": 0, "dataNum": 0} || { data: [] };

        // 创建 BPMN 查看器
        const viewer = new BpmnJS({
            container: '#canvas'
        });

        // 直接使用 XML 数据
        const xmlData = `<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:flowable="http://flowable.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.flowable.org/processdef">
  <signal id="degree" name="满意度回访" flowable:scope="processInstance"></signal>
  <process id="hn_new_complaint_v1" name="湖南政企云化投诉流程-v1" isExecutable="true">
    <documentation>湖南政企云化投诉流程-v1</documentation>
    <startEvent id="startEvent1"></startEvent>
    <userTask id="zdgdfp" name="Z端工单分派" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="zdgdsl" name="Z端工单受理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="zdgdcl" name="Z端工单处理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="zdgdzj" name="Z端工单质检" flowable:candidateGroups="${group}" flowable:formKey="commonForm"></userTask>
    <endEvent id="sid-D5B41C07-339C-4A5D-9CC9-BAA0431B3BE7"></endEvent>
    <userTask id="gdfq" name="工单发起" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="gd" name="归档" flowable:assignee="${user}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <sequenceFlow id="sid-355831ED-8AA8-4ACB-84D7-ED01512646BB" sourceRef="startEvent1" targetRef="gdfq"></sequenceFlow>
    <userTask id="eomsgdsl" name="EOMS工单受理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="eomsgdcl" name="EOMS工单处理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="zdgdyy" name="Z端工单预约" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="zdgdsm" name="Z端工单上门" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <inclusiveGateway id="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8"></inclusiveGateway>
    <sequenceFlow id="sid-49CCBD04-D1F9-49C7-A295-A35BAB18CD98" sourceRef="gdfq" targetRef="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8"></sequenceFlow>
    <userTask id="zdzpsh" name="Z端转派审核" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <sequenceFlow id="sid-FA2BEFEC-A9F3-4163-98BE-E67F6B2E648A" name="Z端转派审核不通过" sourceRef="zdzpsh" targetRef="zdgdyy">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='转派审核不通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-28672663-0F3E-4B98-AE2B-AF1598E88F38" name="Z端工单回复" sourceRef="zdgdcl" targetRef="zdgdzj">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${processResult=='回复'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-F83F710D-7AF4-4FEE-A0D2-E39A1F4BA074" sourceRef="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8" targetRef="zdgdfp">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${Ztype=='true'}]]></conditionExpression>
    </sequenceFlow>
    <inclusiveGateway id="sid-AA472380-B099-43D9-9566-E67A3A222C0C"></inclusiveGateway>
    <sequenceFlow id="sid-F3070952-8857-4C67-828B-CEF91146E673" sourceRef="eomsgdsl" targetRef="eomsgdcl"></sequenceFlow>
    <userTask id="eomsgdzj" name="EOMS工单质检" flowable:candidateGroups="${group}" flowable:formKey="commonForm"></userTask>
    <sequenceFlow id="sid-36ACB3E7-D007-4C0D-91D4-9BD2C3EE13C2" sourceRef="eomsgdcl" targetRef="eomsgdzj"></sequenceFlow>
    <sequenceFlow id="sid-56523437-FF31-4EB6-BC1C-EDA1E405ACA4" sourceRef="eomsgdzj" targetRef="sid-AA472380-B099-43D9-9566-E67A3A222C0C"></sequenceFlow>
    <sequenceFlow id="sid-98F7A1A3-C660-4709-A588-8E0BBF3BB998" name="受理驳回" sourceRef="zdgdsl" targetRef="zdgdfp">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='驳回'}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="adgdfp" name="A端工单分派" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="adgdsl" name="A端工单受理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="adgdcl" name="A端工单处理" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="adgdzj" name="A端工单质检" flowable:candidateGroups="${group}" flowable:formKey="commonForm"></userTask>
    <userTask id="adgdyy" name="A端工单预约" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="adgdsm" name="A端工单上门" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <userTask id="adzpsh" name="A端转派审核" flowable:assignee="${user}" flowable:candidateGroups="${group}" flowable:formKey="commonForm">
      <extensionElements>
        <modeler:initiator-can-complete xmlns:modeler="http://flowable.org/modeler"><![CDATA[false]]></modeler:initiator-can-complete>
      </extensionElements>
    </userTask>
    <sequenceFlow id="sid-F68777A4-BE78-44B0-BF21-D7F1CF83A040" name="Z端转派审核通过" sourceRef="adzpsh" targetRef="adgdsl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='转派审核通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-65C469B4-5F38-4CB5-8BC6-2709DAC9A117" sourceRef="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8" targetRef="adgdfp">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${Atype=='true'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-C2A26587-4BE3-4892-A5ED-342B6CC1C353" name="预约转派" sourceRef="adgdyy" targetRef="adzpsh">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='预约转派'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-8F9944B2-06A7-42D1-A60B-B667FC3DB526" name="A端转派审核不通过" sourceRef="adzpsh" targetRef="adgdyy">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='转派审核不通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-AFDF30D1-4F77-4D11-85A2-DC5A8270D9BE" name="受理通过" sourceRef="zdgdsl" targetRef="zdgdyy">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='受理通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-A0A03903-F3EF-4AF1-AD41-FB759E0F6FF7" sourceRef="gd" targetRef="sid-D5B41C07-339C-4A5D-9CC9-BAA0431B3BE7"></sequenceFlow>
    <sequenceFlow id="sid-CE26FF18-8DEB-45B4-A82D-E28F1EAB2497" name="预约转派" sourceRef="zdgdyy" targetRef="zdzpsh">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='预约转派'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-787A2EE0-DAC8-4C49-9262-8ADD877E212D" name="通过" sourceRef="zdgdyy" targetRef="zdgdsm">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-5D180312-74D4-45E1-AF4F-6CC4AB12DEF6" sourceRef="zdgdsm" targetRef="zdgdcl"></sequenceFlow>
    <sequenceFlow id="sid-E7351B30-5CB8-4680-B65B-9C09F78EE953" sourceRef="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8" targetRef="eomsgdsl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${EOMStype=='true'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-193DA8BE-40A6-4821-B66F-BB8E03A9381F" sourceRef="adgdsm" targetRef="adgdcl"></sequenceFlow>
    <sequenceFlow id="sid-FA25FC31-251D-4AA8-9964-B91390AE6ADB" name="通过" sourceRef="adgdyy" targetRef="adgdsm">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-143B5544-03F8-4239-87C4-6C2108A112AA" name="受理通过" sourceRef="adgdsl" targetRef="adgdyy">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='受理通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-843ED231-9D8D-4F6A-8B9F-80C2C8697E19" sourceRef="zdgdzj" targetRef="sid-AA472380-B099-43D9-9566-E67A3A222C0C">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-8BCF5411-685B-46D8-ACE2-6AB1B334741F" sourceRef="sid-AA472380-B099-43D9-9566-E67A3A222C0C" targetRef="gd"></sequenceFlow>
    <sequenceFlow id="sid-38A1AAE3-6007-4DFC-917F-296344DBD82C" name="A端工单回复" sourceRef="adgdcl" targetRef="adgdzj">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${processResult=='回复'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-ECCD1E72-EF9A-42C3-8601-F660433BBD8B" name="Z端质检驳回" sourceRef="adgdzj" targetRef="adgdcl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='延时'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-13FE5821-F643-428D-A04D-DBC62EE4ED69" name="Z端质检驳回" sourceRef="adgdzj" targetRef="adgdcl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='驳回'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-24A814B3-2856-404D-99AE-D40EB50696E1" sourceRef="adgdzj" targetRef="sid-AA472380-B099-43D9-9566-E67A3A222C0C">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-9F46BCD2-D166-4EF1-AE80-7839D01D4686" name="Z端转派审核通过" sourceRef="zdzpsh" targetRef="zdgdsl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='转派审核通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-01DCF20F-3B4D-44A5-AFBC-A395766D9B79" sourceRef="zdgdfp" targetRef="zdgdsl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-4FFE1D53-1DDF-4EB3-8073-681F6F6D8BCB" name="受理驳回" sourceRef="adgdsl" targetRef="adgdfp">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='驳回'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-0004895D-2420-42C7-A2BA-C5B33A4A4EF2" sourceRef="adgdfp" targetRef="adgdsl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${result=='通过'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-73EB13B2-AF1E-41F0-A8F6-8ADB9B74A432" name="Z端质检驳回" sourceRef="zdgdzj" targetRef="zdgdcl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='驳回'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="sid-22B68895-1574-4DBD-8304-006625941360" name="Z端质检延时" sourceRef="zdgdzj" targetRef="zdgdcl">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${checkResult=='延时'}]]></conditionExpression>
    </sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_hn_new_complaint_v1">
    <bpmndi:BPMNPlane bpmnElement="hn_new_complaint_v1" id="BPMNPlane_hn_new_complaint_v1">
      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
        <omgdc:Bounds height="30.0" width="30.0" x="45.0" y="353.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdfp" id="BPMNShape_zdgdfp">
        <omgdc:Bounds height="80.0" width="100.0" x="224.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdsl" id="BPMNShape_zdgdsl">
        <omgdc:Bounds height="80.0" width="100.0" x="435.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdcl" id="BPMNShape_zdgdcl">
        <omgdc:Bounds height="80.0" width="100.0" x="990.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdzj" id="BPMNShape_zdgdzj">
        <omgdc:Bounds height="80.0" width="100.0" x="1230.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-D5B41C07-339C-4A5D-9CC9-BAA0431B3BE7" id="BPMNShape_sid-D5B41C07-339C-4A5D-9CC9-BAA0431B3BE7">
        <omgdc:Bounds height="28.0" width="28.0" x="1545.0" y="354.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="gdfq" id="BPMNShape_gdfq">
        <omgdc:Bounds height="80.0" width="100.0" x="105.0" y="328.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="gd" id="BPMNShape_gd">
        <omgdc:Bounds height="80.0" width="100.0" x="1395.0" y="328.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="eomsgdsl" id="BPMNShape_eomsgdsl">
        <omgdc:Bounds height="80.0" width="100.0" x="345.0" y="328.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="eomsgdcl" id="BPMNShape_eomsgdcl">
        <omgdc:Bounds height="80.0" width="100.0" x="600.0" y="328.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdyy" id="BPMNShape_zdgdyy">
        <omgdc:Bounds height="80.0" width="100.0" x="600.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdgdsm" id="BPMNShape_zdgdsm">
        <omgdc:Bounds height="80.0" width="100.0" x="795.0" y="210.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8" id="BPMNShape_sid-7DA022AE-A7B5-49C4-9283-89524FDFACE8">
        <omgdc:Bounds height="40.0" width="40.0" x="254.0" y="348.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zdzpsh" id="BPMNShape_zdzpsh">
        <omgdc:Bounds height="80.0" width="100.0" x="600.0" y="60.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sid-AA472380-B099-43D9-9566-E67A3A222C0C" id="BPMNShape_sid-AA472380-B099-43D9-9566-E67A3A222C0C">
        <omgdc:Bounds height="40.0" width="40.0" x="1305.0" y="348.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="eomsgdzj" id="BPMNShape_eomsgdzj">
        <omgdc:Bounds height="80.0" width="100.0" x="1065.0" y="328.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdfp" id="BPMNShape_adgdfp">
        <omgdc:Bounds height="80.0" width="100.0" x="225.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdsl" id="BPMNShape_adgdsl">
        <omgdc:Bounds height="80.0" width="100.0" x="435.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdcl" id="BPMNShape_adgdcl">
        <omgdc:Bounds height="80.0" width="100.0" x="990.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdzj" id="BPMNShape_adgdzj">
        <omgdc:Bounds height="80.0" width="100.0" x="1230.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdyy" id="BPMNShape_adgdyy">
        <omgdc:Bounds height="80.0" width="100.0" x="601.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adgdsm" id="BPMNShape_adgdsm">
        <omgdc:Bounds height="80.0" width="100.0" x="796.0" y="465.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="adzpsh" id="BPMNShape_adzpsh">
        <omgdc:Bounds height="80.0" width="100.0" x="601.0" y="600.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="sid-28672663-0F3E-4B98-AE2B-AF1598E88F38" id="BPMNEdge_sid-28672663-0F3E-4B98-AE2B-AF1598E88F38">
        <omgdi:waypoint x="1089.9499999999477" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="1230.0" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-8F9944B2-06A7-42D1-A60B-B667FC3DB526" id="BPMNEdge_sid-8F9944B2-06A7-42D1-A60B-B667FC3DB526">
        <omgdi:waypoint x="651.0" y="600.0"></omgdi:waypoint>
        <omgdi:waypoint x="651.0" y="544.95"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-FA2BEFEC-A9F3-4163-98BE-E67F6B2E648A" id="BPMNEdge_sid-FA2BEFEC-A9F3-4163-98BE-E67F6B2E648A">
        <omgdi:waypoint x="650.0" y="139.95"></omgdi:waypoint>
        <omgdi:waypoint x="650.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-843ED231-9D8D-4F6A-8B9F-80C2C8697E19" id="BPMNEdge_sid-843ED231-9D8D-4F6A-8B9F-80C2C8697E19">
        <omgdi:waypoint x="1295.2351694915253" y="289.95000000000005"></omgdi:waypoint>
        <omgdi:waypoint x="1319.478527607362" y="353.5018393623545"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-73EB13B2-AF1E-41F0-A8F6-8ADB9B74A432" id="BPMNEdge_sid-73EB13B2-AF1E-41F0-A8F6-8ADB9B74A432">
        <omgdi:waypoint x="1230.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="1089.9499999999252" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-65C469B4-5F38-4CB5-8BC6-2709DAC9A117" id="BPMNEdge_sid-65C469B4-5F38-4CB5-8BC6-2709DAC9A117">
        <omgdi:waypoint x="274.14456521739123" y="387.7983164373643"></omgdi:waypoint>
        <omgdi:waypoint x="274.7080291970803" y="465.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-E7351B30-5CB8-4680-B65B-9C09F78EE953" id="BPMNEdge_sid-E7351B30-5CB8-4680-B65B-9C09F78EE953">
        <omgdi:waypoint x="293.94176300578033" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="344.99999999985056" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-22B68895-1574-4DBD-8304-006625941360" id="BPMNEdge_sid-22B68895-1574-4DBD-8304-006625941360">
        <omgdi:waypoint x="1230.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="1089.9499999999252" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-5D180312-74D4-45E1-AF4F-6CC4AB12DEF6" id="BPMNEdge_sid-5D180312-74D4-45E1-AF4F-6CC4AB12DEF6">
        <omgdi:waypoint x="894.9499999999999" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="990.0" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-4FFE1D53-1DDF-4EB3-8073-681F6F6D8BCB" id="BPMNEdge_sid-4FFE1D53-1DDF-4EB3-8073-681F6F6D8BCB">
        <omgdi:waypoint x="435.0" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="324.94999999972583" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-F3070952-8857-4C67-828B-CEF91146E673" id="BPMNEdge_sid-F3070952-8857-4C67-828B-CEF91146E673">
        <omgdi:waypoint x="444.94999999966626" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="599.9999999998755" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-F68777A4-BE78-44B0-BF21-D7F1CF83A040" id="BPMNEdge_sid-F68777A4-BE78-44B0-BF21-D7F1CF83A040">
        <omgdi:waypoint x="600.9999999999619" y="640.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="640.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="544.95"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-8BCF5411-685B-46D8-ACE2-6AB1B334741F" id="BPMNEdge_sid-8BCF5411-685B-46D8-ACE2-6AB1B334741F">
        <omgdi:waypoint x="1344.941694421308" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="1394.9999999999097" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-CE26FF18-8DEB-45B4-A82D-E28F1EAB2497" id="BPMNEdge_sid-CE26FF18-8DEB-45B4-A82D-E28F1EAB2497">
        <omgdi:waypoint x="650.0" y="210.0"></omgdi:waypoint>
        <omgdi:waypoint x="650.0" y="139.95"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-13FE5821-F643-428D-A04D-DBC62EE4ED69" id="BPMNEdge_sid-13FE5821-F643-428D-A04D-DBC62EE4ED69">
        <omgdi:waypoint x="1230.0" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="1089.95" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-49CCBD04-D1F9-49C7-A295-A35BAB18CD98" id="BPMNEdge_sid-49CCBD04-D1F9-49C7-A295-A35BAB18CD98">
        <omgdi:waypoint x="204.9499999999878" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="254.0" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-36ACB3E7-D007-4C0D-91D4-9BD2C3EE13C2" id="BPMNEdge_sid-36ACB3E7-D007-4C0D-91D4-9BD2C3EE13C2">
        <omgdi:waypoint x="699.9499999996174" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="1064.9999999997738" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-C2A26587-4BE3-4892-A5ED-342B6CC1C353" id="BPMNEdge_sid-C2A26587-4BE3-4892-A5ED-342B6CC1C353">
        <omgdi:waypoint x="651.0" y="544.95"></omgdi:waypoint>
        <omgdi:waypoint x="651.0" y="600.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-355831ED-8AA8-4ACB-84D7-ED01512646BB" id="BPMNEdge_sid-355831ED-8AA8-4ACB-84D7-ED01512646BB">
        <omgdi:waypoint x="74.94999797575196" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="104.99999999999278" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-787A2EE0-DAC8-4C49-9262-8ADD877E212D" id="BPMNEdge_sid-787A2EE0-DAC8-4C49-9262-8ADD877E212D">
        <omgdi:waypoint x="699.9499999999999" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="795.0" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-FA25FC31-251D-4AA8-9964-B91390AE6ADB" id="BPMNEdge_sid-FA25FC31-251D-4AA8-9964-B91390AE6ADB">
        <omgdi:waypoint x="700.9499999999999" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="796.0" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-9F46BCD2-D166-4EF1-AE80-7839D01D4686" id="BPMNEdge_sid-9F46BCD2-D166-4EF1-AE80-7839D01D4686">
        <omgdi:waypoint x="599.9999999999781" y="100.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="100.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="210.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-0004895D-2420-42C7-A2BA-C5B33A4A4EF2" id="BPMNEdge_sid-0004895D-2420-42C7-A2BA-C5B33A4A4EF2">
        <omgdi:waypoint x="324.94999999995036" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="434.9999999998776" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-F83F710D-7AF4-4FEE-A0D2-E39A1F4BA074" id="BPMNEdge_sid-F83F710D-7AF4-4FEE-A0D2-E39A1F4BA074">
        <omgdi:waypoint x="274.0" y="348.0"></omgdi:waypoint>
        <omgdi:waypoint x="274.0" y="289.95000000000005"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-24A814B3-2856-404D-99AE-D40EB50696E1" id="BPMNEdge_sid-24A814B3-2856-404D-99AE-D40EB50696E1">
        <omgdi:waypoint x="1293.1222627737227" y="465.0"></omgdi:waypoint>
        <omgdi:waypoint x="1320.054945054945" y="383.01730769230767"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-A0A03903-F3EF-4AF1-AD41-FB759E0F6FF7" id="BPMNEdge_sid-A0A03903-F3EF-4AF1-AD41-FB759E0F6FF7">
        <omgdi:waypoint x="1494.949999999996" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="1545.0" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-38A1AAE3-6007-4DFC-917F-296344DBD82C" id="BPMNEdge_sid-38A1AAE3-6007-4DFC-917F-296344DBD82C">
        <omgdi:waypoint x="1089.9499999994018" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="1230.0" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-143B5544-03F8-4239-87C4-6C2108A112AA" id="BPMNEdge_sid-143B5544-03F8-4239-87C4-6C2108A112AA">
        <omgdi:waypoint x="534.9499999999432" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="601.0" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-AFDF30D1-4F77-4D11-85A2-DC5A8270D9BE" id="BPMNEdge_sid-AFDF30D1-4F77-4D11-85A2-DC5A8270D9BE">
        <omgdi:waypoint x="534.9499999998898" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="599.9999999999847" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-ECCD1E72-EF9A-42C3-8601-F660433BBD8B" id="BPMNEdge_sid-ECCD1E72-EF9A-42C3-8601-F660433BBD8B">
        <omgdi:waypoint x="1230.0" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="1089.95" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-01DCF20F-3B4D-44A5-AFBC-A395766D9B79" id="BPMNEdge_sid-01DCF20F-3B4D-44A5-AFBC-A395766D9B79">
        <omgdi:waypoint x="323.95000000000005" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="434.99999999999125" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-98F7A1A3-C660-4709-A588-8E0BBF3BB998" id="BPMNEdge_sid-98F7A1A3-C660-4709-A588-8E0BBF3BB998">
        <omgdi:waypoint x="435.0" y="250.0"></omgdi:waypoint>
        <omgdi:waypoint x="323.95000000000005" y="250.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-56523437-FF31-4EB6-BC1C-EDA1E405ACA4" id="BPMNEdge_sid-56523437-FF31-4EB6-BC1C-EDA1E405ACA4">
        <omgdi:waypoint x="1164.95" y="368.0"></omgdi:waypoint>
        <omgdi:waypoint x="1305.0" y="368.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="sid-193DA8BE-40A6-4821-B66F-BB8E03A9381F" id="BPMNEdge_sid-193DA8BE-40A6-4821-B66F-BB8E03A9381F">
        <omgdi:waypoint x="895.9499999997493" y="505.0"></omgdi:waypoint>
        <omgdi:waypoint x="989.9999999999171" y="505.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>`;  // 这里会被 Python 脚本替换为实际的 XML 内容

        // 预处理 XML 数据，替换变量
        function preprocessXML(xml) {
            return xml.replace(/\${user}/g, user)
                     .replace(/\${group}/g, group)
                     .replace(/\${result}/g, result)
                     .replace(/\${processResult}/g, processResult)
                     .replace(/\${Ztype}/g, Ztype)
                     .replace(/\${Atype}/g, Atype)
                     .replace(/\${EOMStype}/g, EOMStype)
                     .replace(/\${checkResult}/g, checkResult);
        }
        
        function handleUserTaskEvent(event, eventName, tooltipPanel) {
            if (eventName === 'element.mousemove') {
                const taskInfo = taskData.data.find(task => task.taskDefKey === event.element.id) || {};
                
                // 处理操作内容的显示逻辑
                let operationContent = '-';
                if (taskInfo.taskName) {
                    operationContent = taskInfo.opResult ? 
                        `${taskInfo.taskName}(${taskInfo.opResult})` : 
                        taskInfo.taskName;
                }

                // 更新提示框内容
                const html = `
                    <div class="tooltip-content">
                        <div class="tooltip-row">
                            <span class="tooltip-label">操作人：</span>
                            <span class="tooltip-value">${taskInfo.handler || '-'}</span>
                        </div>
                        <div class="tooltip-row">
                            <span class="tooltip-label">联系方式：</span>
                            <span class="tooltip-value">${taskInfo.handlerContact || '-'}</span>
                        </div>
                        <div class="tooltip-row">
                            <span class="tooltip-label">部门：</span>
                            <span class="tooltip-value">${taskInfo.dept || '-'}</span>
                        </div>
                        <div class="tooltip-row">
                            <span class="tooltip-label">操作内容：</span>
                            <span class="tooltip-value">${operationContent}</span>
                        </div>
                        <div class="tooltip-row">
                            <span class="tooltip-label">操作时间：</span>
                            <span class="tooltip-value">${taskInfo.endTime || '-'}</span>
                        </div>
                    </div>
                `;
                
                tooltipPanel.innerHTML = html;
                tooltipPanel.style.display = 'block';
                
                // 计算提示框的位置
                let left = event.originalEvent.pageX + 15;
                let top = event.originalEvent.pageY + 15;
                
                // 获取视口尺寸和提示框尺寸
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;
                const tooltipWidth = tooltipPanel.offsetWidth;
                const tooltipHeight = tooltipPanel.offsetHeight;

                // 检查右边界
                if (left + tooltipWidth > viewportWidth - 20) {
                    left = event.originalEvent.pageX - tooltipWidth - 15;
                }

                // 检查左边界
                if (left < 20) {
                    left = 20;
                }

                // 检查下边界
                if (top + tooltipHeight > viewportHeight - 20) {
                    top = event.originalEvent.pageY - tooltipHeight - 15;
                }

                // 检查上边界
                if (top < 20) {
                    top = 20;
                }

                
                tooltipPanel.style.top = `${top}px`;
                tooltipPanel.style.left = `${left}px`;
            }
            
            if (eventName === 'element.out') {
                tooltipPanel.style.display = 'none';
            }
        }

        // 更新任务节点颜色
        function updateTaskColors() {
            const canvas = viewer.get('canvas');
            const elementRegistry = viewer.get('elementRegistry');

            // 遍历所有任务节点
            elementRegistry.forEach(element => {
                if (element.type === 'bpmn:UserTask') {
                    const taskInfo = taskData.data.find(task => task.taskDefKey === element.id);
                    
                    if (taskInfo) {
                        // 已完成的任务
                        canvas.addMarker(element.id, 'completed-task');
                        
                        // 更新连接线颜色
                        element.incoming.forEach(flow => {
                            canvas.addMarker(flow.id, 'completed-path');
                        });
                    } else {
                        // 待处理的任务
                        canvas.addMarker(element.id, 'pending-task');
                    }
                }
            });
        }

        // 加载 XML
        async function loadXML(xmlContent) {
            try {
                const processedXML = preprocessXML(xmlContent);
                await viewer.importXML(processedXML);
                viewer.get('canvas').zoom('fit-viewport', 'auto');
                
                // 更新任务节点颜色
                updateTaskColors();
                
                // 添加事件监听
                setupEventListeners();
            } catch (err) {
                console.error('Error loading XML:', err);
            }
        }

        // 设置事件监听器
        function setupEventListeners() {
            const eventBus = viewer.get('eventBus');
            const tooltipPanel = document.getElementById('tooltip-panel');

            ['element.click', 'element.dblclick', 'element.mousemove', 'element.out'].forEach(eventName => {
                eventBus.on(eventName, event => {
                    if (event.element.type === 'bpmn:UserTask') {
                        handleUserTaskEvent(event, eventName, tooltipPanel);
                    }
                });
            });
        }

        // 启动应用
        window.onload = function() {
            loadXML(xmlData);
        };
    </script>
</body>
</html>